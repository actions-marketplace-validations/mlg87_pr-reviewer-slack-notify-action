# PR Reviewer Slack Notify Action

This action will either DM or post a message to a channel in Slack when users are added as reviewers to PRs. This is very easy to set up, but will require you to create an app in Slack as well where you can create incoming webhooks for your desired destinations.

## Setting up the Slack app

[Create a Slack App](https://api.slack.com/apps) with `Incoming Webhooks`, `Bots` and `Permissions` functionality. It is worth noting that you will need administrator privileges for this, so hit up your IT team in advance. Once the app is created install it to your workspace. If you are wanting the app to be able to post in private channels, you will need to add the app to the private channel _before_ the private channel will show up as an option when creating the incoming webhooks.

Navigate to `https://api.slack.com/apps/[YOUR_SLACK_APP_ID]/incoming-webhooks` and add a new webhook URL for your workspace. If you are only interested in setting the action up to post to a channel, you only need to create a webhook for that channel. If you are interested in having the action DM users, you will need to create a webhook for each user.

## Adding the action to your project

In your `./github/workflows` directory, add a `slackNotify.yml` (or whatever the hell you want to call it) file. Add the following as contents:

```yml
name: PR Review Slack Notify
on:
  pull_request:
    types: [review_requested]

jobs:
  notify:
    runs-on: ubuntu-latest
    name: PR Review Slack Notify
    steps:
      - name: Send slack notifications to requested reviewers
        id: pr-slack-notify
        uses: mlg87/pr-reviewer-slack-notify@v1.0.0
        with:
          channel-webhook: "[WEBHOOK_URL_GENERATED_FOR_A_CHANNEL]"
          slack-users: '[{ "github_username": "mlg87", "slack_id": "[GET_ME_FROM_YOUR_SLACK_WORKSPACE]", "slack_webhook": "[WEBHOOK_URL_GENERATED_FOR_A_SPECIFIC_USER]" }]'
```

## Action inputs

| Input             | Description                                                                                                                           | Required | Type     | Default |
| ----------------- | ------------------------------------------------------------------------------------------------------------------------------------- | -------- | -------- | ------- |
| `channel-webhook` | Webhook generated by your Slack app for a specific channel.                                                                           | `false`  | `String` | `''`    |
| `slack-users`     | Stringified array of individual users. User shape should match `{ github_username: String, slack_id: String, slack_webhook: String }` | `true`   | `JSON`   | `'[]'`  |

##### NOTE: I recommend storing the webhooks as secrets in github
